import ctypes
import time

# Get a handle to the user32.dll
user32 = ctypes.WinDLL("User32.dll")

def toggle_caps_lock():
    # Check the current state of Caps Lock
    caps_state = user32.GetKeyState(0x14)
    # If Caps Lock is on, turn it off; otherwise, turn it on
    if caps_state == 1:
        user32.keybd_event(0x14, 0, 2, 0)  # Key up
    else:
        user32.keybd_event(0x14, 0, 0, 0)  # Key down

# Infinite loop to toggle Caps Lock
while True:
    toggle_caps_lock()
    time.sleep(0.5)  # Toggling interval; adjust as needed